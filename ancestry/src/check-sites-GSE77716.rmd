---
title: Differentiating between Mexican and Puerto Rican ancestry
---

> Galanter JM, Gignoux CR, Oh SS, Torgerson D et al. Differential methylation between ethnic sub-groups reflects the effect of genetic ancestry and environmental exposures. Elife 2017 Jan 3;6. PMID: 28044981

> https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE77716

```{r}
kableone(CreateTableOne(colnames(vars), data=vars), showAllLevels=T)
```

Restricting to just Mexican and Puerto Rican.
```{r}
idx <- which(vars$ethnicity %in% c("Mexican","Puerto Rican"))
vars <- vars[idx,]
meth <- meth[,idx]
```

```{r}
all.sites <- unique(sites$cpg)
```

`r length(intersect(all.sites, rownames(meth)))`
of the `r length(all.sites)` 
selected mQTL CpG sites are in the DNAm dataset.

```{r}
pca.ret <- prcomp(t(meth[rownames(meth)%in% all.sites,]), scale=T)
```

```{r, results="asis"}
stats <- t(apply(pca.ret$x[,1:10], 2, function(p) {
    coef(summary(lm(p~vars$ethnicity)))[2,]
}))
lmable(stats,digits=3)
```

```{r}
best <- order(stats[,ncol(stats)])[1:2]
autoplot(pca.ret, x=best[1], y=best[2], data=vars, colour = 'ethnicity', title="all sites")
```

```{r}
sel.sites <- sites$cpg[sites$ancestry %in% c("AMR","CLM","MXL","PEL","PUR")]
```

`r round(mean(all.sites %in% sel.sites)*100,1)`%
of the mQTL CpG sites were selected to differentiate between
European (EUR) and admixed American (AMR) ancestries.

```{r}
pca.ret <- prcomp(t(meth[rownames(meth)%in% sel.sites,]), scale=T)
```

```{r, results="asis"}
stats <- t(apply(pca.ret$x[,1:10], 2, function(p) coef(summary(lm(p~vars$ethnicity)))[2,]))
lmable(stats,digits=3)
```

```{r}
best <- order(stats[,ncol(stats)])[1:2]
autoplot(pca.ret, x=best[1], y=best[2], data=vars, colour = 'ethnicity', title="selected sites")
```

